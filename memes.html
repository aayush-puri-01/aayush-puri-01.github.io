<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meme Mode</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      overflow: hidden; /* prevent accidental scroll when button moves */
    }
    #escape-btn {
      position: absolute;
      transition: transform 0.25s ease, top 0.25s ease, left 0.25s ease;
      z-index: 999;
      max-width: 200px;
      word-wrap: break-word;
    }
    .content {
      position: relative;
      text-align: center;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    video {
      max-width: 95vw;
      border-radius: 12px;
    }
  </style>
</head>
<body class="scary-body">
  <div class="content">
    <video id="meme-player" controls autoplay playsinline></video>
    <button id="escape-btn" class="modern-btn glass-btn">Click to Escape</button>
    <h2 id="end-message" style="display:none; margin-top: 2rem;">ðŸŽƒ Happy Halloween! ðŸŽƒ</h2>
  </div>

  <script>
    // --- Meme video playback sequence ---
    const videos = ["vid2.mp4", "vid1.mp4", "vid3.mp4", "vid4.mp4", "vid5.mp4", "vid6.mp4"]; // your meme videos
    const player = document.getElementById('meme-player');
    const escapeBtn = document.getElementById("escape-btn");
    const endMsg = document.getElementById("end-message");
    let index = 0;

    player.src = videos[index];
    player.onended = () => {
      index++;
      if (index < videos.length) {
        player.src = videos[index];
      } else {
        player.style.display = "none";
        escapeBtn.style.display = "none";
        endMsg.style.display = "block";
      }
    };

    // --- Moving escape button (stays within screen bounds) ---
    function moveButtonAway(event) {
      const btnRect = escapeBtn.getBoundingClientRect();
      const pageWidth = window.innerWidth;
      const pageHeight = window.innerHeight;

      // Cursor/touch position
      let x = event.touches ? event.touches[0].clientX : event.clientX;
      let y = event.touches ? event.touches[0].clientY : event.clientY;

      const threshold = 120; // distance at which button flees

      // If pointer is near the button
      if (
        x > btnRect.left - threshold &&
        x < btnRect.right + threshold &&
        y > btnRect.top - threshold &&
        y < btnRect.bottom + threshold
      ) {
        const btnWidth = btnRect.width;
        const btnHeight = btnRect.height;
        const safeMargin = 20;

        // Generate new random position within bounds
        const newLeft = Math.max(
          safeMargin,
          Math.min(Math.random() * (pageWidth - btnWidth - safeMargin), pageWidth - btnWidth - safeMargin)
        );
        const newTop = Math.max(
          safeMargin,
          Math.min(Math.random() * (pageHeight - btnHeight - safeMargin), pageHeight - btnHeight - safeMargin)
        );

        escapeBtn.style.left = newLeft + "px";
        escapeBtn.style.top = newTop + "px";
      }
    }

    // Move when approaching with mouse or touch
    document.addEventListener("mousemove", moveButtonAway);
    document.addEventListener("touchmove", moveButtonAway, { passive: true });

    // Just in case someone taps directly on it
    escapeBtn.addEventListener("click", (e) => {
      e.preventDefault();
      moveButtonAway({ clientX: 0, clientY: 0 });
    });

    // Initial safe placement (center-ish)
    window.addEventListener("load", () => {
      const startLeft = window.innerWidth / 2 - escapeBtn.offsetWidth / 2;
      const startTop = window.innerHeight * 0.75;
      escapeBtn.style.left = startLeft + "px";
      escapeBtn.style.top = startTop + "px";
    });
  </script>
</body>
</html>
